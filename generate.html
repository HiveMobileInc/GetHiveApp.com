<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Hive | Create your Hive</title>
		<meta charset="UTF-8" />
		<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"/>
		<meta name="apple-mobile-web-app-capable" content="yes"/>
		<meta name="description" content="Enable Conversations everywhere with Hive: Generate your conversation link now."/>
		<meta property="og:title" content="Enable Conversations Anywhere - Generate yours now."/>
		<meta property="og:site_name" content="Hive"/>
		<meta property="og:description" content="Enable Conversations everywhere with Hive: An intuitive communication platform that works in every situation, and on device and operating system. Generate your conversation link now."/>
		<meta property="og:url" content="//hivemobileinc.github.io/GetHiveApp.com/">
		<meta property="og:image" content="//hivemobileinc.github.io/GetHiveApp.com/img/hive_logo_blue.png"/>
		<meta property="og:type" content="website" />
		<link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,600' rel='stylesheet' type='text/css'/>
		<link rel="shortcut icon" href="img/favicon.ico"/>
		<link rel="stylesheet" type="text/css" href="css/generate.css"/>
	</head>
	<body>
		<img src="img/bg-full.jpg" class="bg" alt=""/>

		<section class="landing generate">
			<div class="container">
				<img class="logo" src="img/logo-w.png" alt="Hive logo"/>
				<h1>Create a Conversation!</h1>
			</div>
		</section>

		<section class="generate-link">
			<div class="container">
				<div class="generate col-xxs-12 col-xs-6 col-xs-offset-3 col-lg-4 col-lg-offset-4" style="padding:0">
					<div id="con-main" class="top">
						<span id="regin" class="regin none">
							<div id="regin-err" class="regin-err none"></div>
							
							<div class="field">
								<input id="username" class="form-control" type="text" name="username" placeholder="username"/>
								<!--
									<div class="feedback">
										<span class="checking">
											<i class="fa fa-refresh fa-spin"></i>Checking...
										</span>
										<span class="available">
											<i class="fa fa-check"></i>Available!
										</span>
										<span class="taken">
											<i class="fa fa-exclamation-triangle"></i>Username taken.
										</span>
										<span class="error">
											<i class="fa fa-times"></i>
											<span class="empty">Don't forget a Username!</span>
										</span>
									</div>
								-->
							</div>
							
							<div class="field">
								<input id="password" class="form-control" type="password" name="password" placeholder="password"/>
								<!--
									<div class="feedback">
										<span class="details active">
											Password must be at least 6 characters
										</span>
										<span class="error">
											<i class="fa fa-times"></i>Your Password is too short!
										</span>
									</div>
								-->
							</div>
							
							<button id="btn-regin" class="btn send">
								<!--
									<span class="log" id="login-text">Login</span>
									<span class="reg" id="register-text">Register</span>
								-->
								Login or Register
							</button>
						</span>

						<span id="load" class="" style="text-align:center;">
							<i class="fa fa-refresh fa-spin"></i>
						</span>

						<span id="gen" class="none">
							<img id="avatar" src="img/guest.png" class="none" style="margin: 10px;"/>
							<input id="inp-title" type="text" placeholder="Choose a title" class="form-control hve-name"/>
							<p id="dsc-pub" class="desc public">
								<i class="fa fa-globe"></i>This conversation can be viewed by anyone.
							</p>
							<button id="btn-create" class="send col-xs-12">Create 
								<span id="txt-title">Your Conversation</span>
							</button>
						</span>
					</div>
					
					<div id="con-gen" class="bottom none">
						<div class="hve-link col-xs-12" style="text-align:center;">
							<span id="gen-url" onclick="return highlight(this);">https://see.rest/URL</span>
						</div>
						<p class="desc private">
							<i class="fa fa-info-circle"></i>
							Copy-paste this link anywhere to start the conversation!
						</p>
					</div>
				</div>
				<div id="logout" class="hve-logout none">
					<span>Logged in as MichaelRurka</span>
					<a href="#" style="color:white;" onclick="return logout();">Logout</a>
				</div>
			</div>
		</section>

		<script src="js/min/index-min.js"></script>
		<script src="https://s3.amazonaws.com/hvejs/hve.js"></script>
		<script type="text/javascript">

			var button_register = $('#button-register');
			var button_login = $('#button-login');
			var text_register = $('#register-text');
			var text_login = $('#login-text');
			var logout_link = $('#logout');

			button_register.click(function () {
				button_register.addClass('selected');
				button_login.removeClass('selected');
				text_register.removeClass('none');
				text_login.addClass('none');
			});

			button_login.click(function () {
				button_register.removeClass('selected');
				button_login.addClass('selected');
				text_register.addClass('none');
				text_login.removeClass('none');
			});

		  	var btn_pub = $('#btn-pub');
		  	var btn_pri = $('#btn-pri');
		  	var dsc_pub = $('#dsc-pub');
		  	var dsc_pri = $('#dsc-pri');
		  	btn_pub.click(function () {
		  		btn_pub.addClass('selected');
		  		dsc_pub.removeClass('none');
		  		btn_pri.removeClass('selected');
		  		dsc_pri.addClass('none');
		  	});
		  	btn_pri.click(function () {
		  		btn_pub.removeClass('selected');
		  		dsc_pub.addClass('none');
		  		btn_pri.addClass('selected');
		  		dsc_pri.removeClass('none');
		  	});

		  	var txt_title = $('#txt-title');
		  	var txt_title_start = txt_title.text();
		  	var inp_title = $('#inp-title');
		  	var btn_create = $('#btn-create');
		  	inp_title.keyup(function (e) {
		  		var l = inp_title.val().length;
		  		if (l == 0) txt_title.text(txt_title_start);
		  		else txt_title.text(l > 21 ? inp_title.val().substr(0, 21) + '...' : inp_title.val());
		  		if (e.keyCode == 13) {
			    	// do nothing on enter
			        return false; 
			    }
		  	});
		  	btn_create.click(function () {
		  		create_conversation(null, inp_title.val(), 'public', function (err, bdy) {
		  			if (err) throw err;
		  			generated(bdy);
		  		});
		  		return false;
		  	});

		  	function generated (bdy) {
		  		$('#con-main').addClass('faded');
		  		$('#con-gen').removeClass('none');
		  		btn_create.addClass('none');
				$('#gen-url').text(bdy.created.url_short);
		  		setTimeout(function () {highlight(document.getElementById('gen-url'));}, 10);
		  	};

		  	function highlight (e) {
			    var range;
			    var selection;    
			    if (document.body.createTextRange) {
			        range = document.body.createTextRange();
			        range.moveToElementText(e);
			        range.select();
			    } else if (window.getSelection) {
			        selection = window.getSelection();        
			        range = document.createRange();
			        range.selectNodeContents(e);
			        selection.removeAllRanges();
			        selection.addRange(range);
			    }
			    return false;
			}

			var username = $('#username');
			var password = $('#password');
			username.keyup(function (e) {
			    if (e.keyCode == 13) {
			    	password.focus();
			        return false; 
			    }
			});
			password.keyup(function (e) {
			    if (e.keyCode == 13) {
			    	return regin_click();
			    }
			});
			var loader = $('#load');
			$('#btn-regin').click(regin_click);
			var con_regin = $('#regin');
			var gen = $('#gen');
			function regin_click () {
				function logged_in () {
					logout_link.removeClass('none');
					loader.addClass('none');
					con_regin.addClass('none');
					gen.removeClass('none');
					$('#avatar').attr('src', bndl.profile.avatar + tkn());
				};
				con_regin.addClass('none');
				loader.removeClass('none');
				if (bndl == null) {
					regin(username.val(), password.val(), function (err, creds) {
						if (err) {
							loader.addClass('none');
							con_regin.removeClass('none');
							$('#regin-err').text(err).removeClass('none');
							throw err;
						}
						logged_in();
					});
				} else logged_in();
				return false;
			};
			function logout () {
				bndl = null;
				localStorage.removeItem('hvebndl');
				location.reload();
				return false;
			};
			function hve_loaded () {
				if (bndl != null) regin_click();
				else {
					con_regin.removeClass('none');
					loader.addClass('none');
				}
			};
		</script>
		<script>
			$('.fa-clipboard').tooltip();
			(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
			ga('create', 'UA-53846051-3', 'auto');
			ga('send', 'pageview');
		</script>
	</body>
</html>