<!DOCTYPE html>
<html lang="en">
<head>
		<title>Hive | Multi-use lightning fast Plugin for Messaging & Commenting</title>
		<meta charset="UTF-8">
		<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
		<meta name="apple-mobile-web-app-capable" content="yes"/>
		<meta name="description" content="">
		<link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,600' rel='stylesheet' type='text/css'>
		<link rel="shortcut icon" href="img/favicon.ico"/>
		<link rel="stylesheet" type="text/css" href="css/screen.css"/>
</head>
<body>


<section class="landing" data-stretch="img/bg2.jpg">
<div class="container">
		<img class="logo" src="img/logo-w.png" alt="Hive logo"/>
		<h1 class="col-xxs-12 col-xs-10 col-xs-offset-1 col-md-8 col-md-offset-2 col-lg-6 col-lg-offset-3">Multi-use lightning fast Plugin for Messaging &amp; Commenting</h1>
</div>
<img src="img/beta.png" class="beta-banner" alt="Hive is Looking for Beta Testers! Click here." usemap="#Map" />
<map name="Map" id="Map">
    <area alt="" title="" href="#" shape="poly" coords="12,1,199,168,199,109,75,0" data-toggle="modal" data-target="#beta-modal"/>
</map>
</section>


<section class="app light">
<div class="container">	

<div class="col-xs-12 col-sm-6 col-md-7 col-lg-6 col-lg-offset-1 plugin">
		<div id="feed" class="feed-area">
		
			<div class="hve-load" id="hve-load"> Joining the conversation<br>
				<i class="fa fa-circle-o-notch fa-spin"></i>
			</div>

			<span id="msg-tmp" class="none">
				<div id="msg-con-HID" class="msg">
					<p>HMSG</p>
					<div class="details">
						<div class="author-img"><a href="#"><img src="img/guest.png" alt=""/></a></div>
						<div class="author-name"><a href="#">HDISPLAYNAME</a></div>
						<br>
						<div class="timestamp">HCREATEDAGO</div>
						
						<a href="#" onclick="return toggle_rep('hve-rep-HID');"><i class="fa report fa-exclamation-triangle"></i></a>
						<span id="hve-rep-HID" class="none">
							<span class="report-label" style="color:#989898;">Report for:</span>	
							<ul class="report">
									<li><a href="#" onclick="return report_msg('MID', 'spam',        'msg-con-HID');">Spam</a></li>
									<li><a href="#" onclick="return report_msg('MID', 'harrassment', 'msg-con-HID');">Harassment</a></li>
									<li><a href="#" onclick="return report_msg('MID', 'copyright',   'msg-con-HID');">Copyright Infringement</a></li>
									<li><a href="#" onclick="return report_msg('MID', 'racism',      'msg-con-HID');">Racism</a></li>
									<li><a href="#" onclick="return toggle_rep('hve-rep-HID');" class="close-report"><i class="fa fa-times"></i> Close</a></li>
							</ul>
						</span>
					</div>
				</div>
			</span>
			<span id="new-mrk"></span>
		</div>

	<div class="post-area">
		<div class="hve-post">
			<div class="textarea"><textarea id="hve-message" placeholder="Type your message!"></textarea></div>
			<span id="ava-editor" class="none">
				<canvas id="edit-avatar-can" class="profile-preview" width="60" height="60"></canvas>
				<input id="edit-avatar" type="file" accept="image/*"/>
			</span>
			<a href="#" id="btn-post-user" onclick="return show_regin();" class="btn user"><i class="fa fa-comment-o"></i><span id="btn-user-text">Login or Register</span></a>
			<a href="#" id="btn-post-guest" onclick="return post_as_guest();" class="btn guest"><i class="fa fa-comment-o"></i>Guest</a>
		</div>
	</div>
	
	<div id="hve-regin" class="hve-regin none">
		<form method="post">
			<span id="regin-header" class="header">Register or Login</span><br>
			<span class="desc">We promise you won't lose your comment!</span><br>
			<label for="username">Username</label>
			<input id="username" type="text" name="username" placeholder="username"><br>
			<label for="password">Password</label>
			<input id="password" type="password" name="password" placeholder="password"><br>
			<a href="#" onclick="return regin_click();" class="btn">Join the Conversation!</a><br>
		</form>
	</div>				
			
</div> <!-- plugin -->

<div class="features col-xs-12 col-sm-5 col-sm-offset-1 col-md-3 col-md-offset-1">
<div class="panel-group" id="accordion">
  <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne"><h2>Hive App Features</h2></a>  
  <div id="collapseOne" class="panel-collapse collapse out">
    <div class="panel-body">
      <div class="col-sm-12">
		<label>Newly Added</label><span>(v 1.0)</span>
		<ul>
			<li><i class="fa fa-circle"></i>Post messages as guest</li>
			<li><i class="fa fa-circle"></i>Login & register as user</li>
			<li><i class="fa fa-circle"></i>Set profile image</li>
			<li><i class="fa fa-circle"></i>Reporting functionality</li>
			<li><i class="fa fa-circle"></i>Embedding abilities</li>
		</ul>
	</div>
	<div class="col-sm-12">
		<label>In Progress</label><span>(v 1.1)</span>
		<ul>
			<li><i class="fa fa-circle-o-notch fa-spin"></i>Image Attachments</li>
		</ul>
	</div>
	<div class="col-sm-12">
		<label>Upcoming</label>
		<ul id="fts">
			<li><i class="fa fa-circle-o-notch fa-spin sending"></i>Example Suggestion</li>
			<li><i class="fa fa-check sent"></i>Example Suggestion</li>
			<li id="rqftb"><input id="rqft" class="form-control" placeholder="Request a feature!"/></li>
		</ul>
	</div>
    </div>
  </div>
</div>
</div> <!-- features -->

</div>
</section> <!-- app -->

<footer class="light">
<div class="container">
<div class="col-lg-10 col-lg-offset-1">
		<ul class="legal">
		<SCRIPT type="text/javascript">eval(unescape('%76%61%72%20%73%3D%27%61%6D%6C%69%6F%74%53%3A%79%61%69%48%47%40%74%65%69%48%65%76%70%41%2E%70%6F%63%6D%27%3B%76%61%72%20%72%3D%27%27%3B%66%6F%72%28%76%61%72%20%69%3D%30%3B%69%3C%73%2E%6C%65%6E%67%74%68%3B%69%2B%2B%2C%69%2B%2B%29%7B%72%3D%72%2B%73%2E%73%75%62%73%74%72%69%6E%67%28%69%2B%31%2C%69%2B%32%29%2B%73%2E%73%75%62%73%74%72%69%6E%67%28%69%2C%69%2B%31%29%7D%64%6F%63%75%6D%65%6E%74%2E%77%72%69%74%65%28%27%3C%61%20%68%72%65%66%3D%22%27%2B%72%2B%27%22%3E%53%61%79%48%69%40%47%65%74%48%69%76%65%41%70%70%2E%63%6F%6D%3C%2F%61%3E%27%29%3B'))</SCRIPT>
		</ul>
		<span class="copyright">&#169; 2014 Hive Mobile Inc.</span>
</div>
</div>
</footer>

<div id="beta-modal" class="modal beta fade" tabindex="-1" role="dialog" aria-labelledby="HiveBeta" aria-hidden="true">
  <div class="modal-dialog beta">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
        <h4 class="modal-title" id="HiveBeta">Hive Beta</h4>
      </div>
      <div class="modal-body">
				Shoot us your contact and our lovely engineer will be in touch with you shortly! Oh, and we'll throw in some free swag for your much appreciated help!
					<form>
						<input id="name" type="text" placeholder="name" class="form-control"/>
						<input id="email" type="email" placeholder="email" class="form-control" required=""/>
					</form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary">Let's do this!!</button>
      </div>
    </div>
  </div>
</div>

<script src="js/min/index-min.js"></script>
<script src="https://s3.amazonaws.com/hvejs/hve.js"></script>
<script> 
	$('section.landing').anystretch();
	
	// handle submitting features
	var rqft = $('#rqft');
	rqft.keyup(function (e) {
	    if (e.keyCode == 13) {
	    	if (rqft.val().length < 3) return false;
	        $('#rqftb').before('<li><i class="fa fa-circle-o req"></i>' + rqft.val() + '</li>');
	        rqft.val('');
	        return false; 
	    }
	});
	var username = $('#username');
	var password = $('#password');
	username.keyup(function (e) {
	    if (e.keyCode == 13) {
	    	password.focus();
	        return false; 
	    }
	});
	password.keyup(function (e) {
	    if (e.keyCode == 13) {
	    	regin_click();
	        return false; 
	    }
	});

	// grab msg template
	var msg_tmp = $('#msg-tmp').html();
	var old_mrk = $('#msg-tmp');
	var new_mrk = $('#new-mrk');

	// grab msg
	var msg_entry = $('#hve-message');

	function show_regin () {
		if (bndl != null) return post_as_user();
		$('#hve-regin').removeClass('none');
		$('html, body').animate({scrollTop: $('#hve-regin').offset().top - 30}, 200);
		username.focus();
	    return false;
	};
	function regin_click () {
		regin(username.val(), password.val(), function (err, creds) {
			if (err) throw err;
			bndl = creds;
			$('#hve-regin').addClass('none');
			$('#btn-user-text').text(creds.profile.display_name);
			$('#ava-editor').removeClass('none');
			$('html, body').animate({scrollTop: msg_entry.offset().top - (window.innerHeight / 3)}, 200);
			msg_entry.focus();
		});
		return false;
	};
	function toggle_rep (id) {
		var e = $('#' + id);
		e.toggleClass('none');
		return false;
	};
	var hop = 1;
	function add_msg (msg, newmsg) {
		console.log(msg);
		var html = msg_tmp.split('HID')          .join(hop++)
		                  .split('MID')          .join(msg.mid)
		                  .split('HMSG')         .join(msg.message)
		                  .split('img/guest.png').join(msg.author.avatar + tkn())
		                  .split('HDISPLAYNAME') .join(msg.author.display_name)
		                  .split('HCREATEDAGO')  .join(msg.created_ago);
		if (newmsg) new_mrk.before(html);
		else old_mrk.after(html);
	};
	function disable_post () {
		msg_entry.prop('disabled', true);
		$('#hve-regin').prop('disabled', true);
		$('#btn-post-user').prop('disabled', true);
		$('#btn-post-guest').prop('disabled', true);
	};
	function enable_post (clear) {
		msg_entry.prop('disabled', false);
		$('#hve-regin').prop('disabled', false);
		$('#btn-post-user').prop('disabled', false);
		$('#btn-post-guest').prop('disabled', false);
		if (clear) {
			msg_entry.val('');
		}
		msg_entry.focus();
	};
	function post_as_user () {
		disable_post();
		post_message(url, msg_entry.val(), null, null, posted, false);
		return false;
	};
	function post_as_guest () {
		disable_post();
		post_message(url, msg_entry.val(), null, null, posted, true);
		return false;
	};
	function posted (err, msg) {
		if (err) {
			enable_post(false);
			throw err;
		}
		for (var m = 0; m < msg.length; m++)
			add_msg(msg[m], true);
		enable_post(true);
	};

	var url = 'gethiveapp.com';
	// catch hive loaded
	function hve_loaded () {
		get_conversation_base(url,  function (err, base) {
			if (err) throw err;
			$('#hve-load').addClass('none');
			for (var b = 0; b < base.length; b++)
				add_msg(base[b], false);
		}, true);
	};

	document.getElementById('edit-avatar').addEventListener('change', new_avatar, false);
	var ava_can = document.getElementById('edit-avatar-can');
	function new_avatar (e) {
		read_img(e.target.files[0], function (img) {
			draw_avatar(img, ava_can, ava_can.getContext('2d'));

			edit_user(null, null, null, null, ava_can.toDataURL('image/png'), function (err, prof) {
				if (err) throw err;
				else bndl.profile = prof;
				console.log(prof);
			});
		});
	};

	function report_msg (mid, report, hid) {
		$('#' + hid).attr('class', 'none')
            .before('<p><i>Thank you for reporting this message, humans will review it shortly.</i></p>');
		report_message(url, mid, report, function (err, res) {
			if (err) throw err;
		});
		return false;
	};
</script>
</body>
</html>